<!DOCTYPE html>
<html>
<head>
  <title>BLE Scanner</title>
</head>
<body>
  <h1>BLE Scanner</h1>
  <button id="start">Start Scan</button>
  <ul id="results"></ul>

  <script>
    let scan;
    const seenDevices = {};

    document.getElementById('start').addEventListener('click', async () => {
      try {
        scan = await navigator.bluetooth.requestLEScan({
          acceptAllAdvertisements: true,
          keepRepeatedDevices: true
        });

        navigator.bluetooth.addEventListener('advertisementreceived', event => {
          const name = event.device.name || 'Unnamed';
          const id = event.device.id;
          if (!seenDevices[id]) {
            seenDevices[id] = true;
            const li = document.createElement('li');
            li.textContent = `üì° ${name} (RSSI: ${event.rssi})`;
            document.getElementById('results').appendChild(li);
          }
        });

      } catch (error) {
        alert("‚ùå Error: " + error);
      }
    });
  </script>
</body>
</html>
